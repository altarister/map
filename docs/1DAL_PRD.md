# [PRD] 일달 (1DAL) : 실전 화물 배차 에이전트

**프로젝트 코드명**: 1DAL (One-Click Dispatch logic)
**작성일**: 2026-02-12
**버전**: 1.1.0 (Future Plan)

---

## 1. 프로젝트 개요 (Overview)

### 1.1 정의

**"일달"**은 화물 차주가 사용하는 **배차 앱(인성, 24시 등)** 위에 투명하게 실행되어, 화면의 콜 정보를 실시간으로 읽고 수익성을 분석해 **"잡아야 할 콜(Green)"과 "버려야 할 콜(Red)"**을 신호등처럼 알려주는 **AI 보조 기사(Co-pilot)**입니다.

### 1.2 핵심 가치

- **속도**: 사람이 계산할 수 없는 속도(0.1초)로 순수익 분석.
- **안전**: 똥콜을 무의식적으로 클릭하는 실수를 시스템적으로 차단.
- **수익**: 철저한 원가 계산을 통해 월 매출이 아닌 **'순이익'** 극대화.

---

## 2. 주요 기능 (Key Features)

### 2.1 신호등 오버레이 (Traffic Light Overlay)

타 화물 앱 리스트 아이템 위에 직관적인 테두리를 씌웁니다.

|   등급   |     색상      | 의미                | 터치 동작                    | 로직 기준                          |
| :------: | :-----------: | :------------------ | :--------------------------- | :--------------------------------- |
| **꿀짐** | 🟢 **Green**  | 즉시 수락 권장      | **Pass-through** (터치 허용) | 순수익 > 목표치 & 시간당 단가 우수 |
| **대기** | 🟡 **Yellow** | 고민 필요 / 분석 중 | **Block** (경고)             | 평균 수준 or 데이터 부족           |
| **똥콜** |  🔴 **Red**   | 절대 수락 금지      | **Touch Block** (터치 차단)  | 순수익 마이너스 or 기피 지역       |

### 2.2 자동 분석 시스템

- **OCR/Accessibility**: 화면의 텍스트(상차지, 하차지, 단가, 톤수)를 실시간 추출.
- **회차 분석**: 도착지가 강원도 오지 등 '짐 싣고 나오기 힘든 곳'이면 단가 패널티 적용.
- **블랙리스트**: 상차 지연이 잦은 물류센터나 악성 주선사를 감지하여 경고.

### 2.3 운행 비서

- **TTS 안내**: "성남에서 부산, 45만 원, 꿀짐입니다!" 라고 음성 브리핑.
- **복귀 모드**: 내 집(차고지) 방향의 콜에는 가산점을 부여하여 집에 가기 쉽게 함.

---

## 3. 기술 아키텍처 (Architecture)

### 3.1 플랫폼

- **OS**: Android (화물 앱 생태계 특성상 안드로이드 전용)
- **Type**: Native App + Accessibility Service + Foreground Service

### 3.2 Tech Stack

- **Framework**: React Native (UI) + Kotlin Native Module (Core Logic)
- **Database**: SQLite (On-device) - 개인 운행 기록 및 블랙리스트 저장
- **API**: TMAP API (거리/경로 산출), Discord Webhook (에러 로그)

---

## 4. 데이터 처리 로직

### 4.1 2단계 필터링 (Dual Filtering)

API 비용 절약과 속도를 위해 두 단계로 거릅니다.

1.  **Local Filter (0.01초)**: `직선거리 x 1.4` 공식을 사용해 대략적인 단가 효율 계산. 여기서 '똥콜'은 즉시 Red 처리하고 API 호출 안 함.
2.  **Server Filter (0.5초)**: 1차 통과한 유망한 콜에 대해 TMAP API를 호출하여 정확한 톨비, 주행거리, 소요시간 계산 후 최종 등급 판정.

### 4.2 수익성 공식 (예시)

```
순이익 = 운임 - (거리 x 연비) - 톨비 - (소요시간 x 시간당임금) - 감가상각비
```

---

## 5. UI/UX 전략

- **방해 금지**: 스크롤 중에는 오버레이를 숨겨서 화면 가림 현상 방지.
- **패닉 버튼**: 오작동 시 볼륨 버튼을 길게 눌러 즉시 종료.
- **왕주먹 버튼**: 운전 중 세밀한 터치가 어려우므로, Green 등급 발견 시 화면 구석에 매우 큰 수락 버튼 생성.
- 폰트 크기 조절 (운전 중 시인성 고려).
- 효과음 On/Off.
- 스타일 변경 (일반/야간 모드).

---

## 6. 개발 로드맵

1.  **PoC (Proof of Concept)**: 접근성 권한으로 화면 텍스트 읽어오기 프로토타입.
2.  **MVP**: 1차 로컬 필터링만 적용된 신호등 UI 구현.
3.  **Alpha**: TMAP 연동 및 회차 로직 적용.
4.  **Beta**: 소수 인원(본인 포함) 필드 테스트 및 블랙리스트 데이터 축적.



1. 상/하차지 평판 시스템 (Site Reputation)
단순히 텍스트로 메모하는 수준을 넘어, 콜이 떴을 때 색상과 아이콘으로 직관적인 경고를 주는 방식입니다.

블랙리스트 (Bad):

기준: 상습적 상/하차 지연, 갑질/불친철, 과도한 수작업 요구.

UI 피드백: 단가가 Green 급이라도 강제로 Yellow 또는 Red로 변경. "불친철/지연 주의" 팝업 노출.

화이트리스트 (Good):

기준: 빠른 상/하차, 친절함, 휴게 시설 좋음, 간식/음료 제공.

UI 피드백: 단가가 조금 낮아도 Green으로 격상. "매너 좋음/빠른 회전" 아이콘 표시.

2. '일달' 내 평가 로직 및 데이터 구조
운행이 종료된 시점에 승욱님이 **'원터치'**로 평가를 남기면, 다음번에 해당 업체 콜이 떴을 때 즉시 반영됩니다.

[운행 종료 후 퀵 평가 팝업]

😃 최고: (로직) 다음번 이 업체 콜은 단가 +5,000원 가산해서 계산.

😐 보통: (로직) 기본값 유지.

😡 최악: (로직) 다음번 이 업체 콜은 단가 -20,000원 페널티 또는 무조건 Red.

[DB 확장 스키마] | 업체명/전화번호 | 평점 | 주요 태그 | 메모 | | :--- | :--- | :--- | :--- | | (주)OO물류 | 😡 1.0 | #상차지연 #불친철 | "입구부터 반말함, 두 번 다시 안 감" | | XX테크 | 😃 5.0 | #빠른상차 #친절 | "담당자 매너 좋음, 커피 주심" |

3. 기획 보강 내용 (PRD 추가 항목)
4.4 현장 평판 기반 동적 필터링 (Site-Reputation Filtering)

평판 데이터 연동: 사용자 피드백(평점, 태그)을 1차/2차 필터링에 즉시 반영.

감성 페널티/인센티브: 불친철 업체는 '심리적 기회비용'을 반영하여 필요 단가를 높게 책정(Red 전환 유도), 우수 업체는 단가가 낮아도 우선 추천.

키워드 경고: 리스트 화면에서 업체명 인식 시 "지연 주의", "친절" 등의 배지를 오버레이로 표시.