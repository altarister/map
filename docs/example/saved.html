<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1DAL Trainer - Technical Specification Interface</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        'brand-green': '#008000',
                        'brand-red': '#FF0000',
                        'brand-grey': '#808080',
                        'ui-bg': '#0a0a0a',
                        'ui-panel': '#141414',
                        'ui-border': '#262626',
                    }
                }
            }
        }
    </script>
    <style>
        :root {
            --brand-green: #008000;
            --brand-red: #FF0000;
        }
        body {
            background-color: #050505;
            color: #e5e5e5;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }
        .glass-panel {
            background: rgba(20, 20, 20, 0.8);
            backdrop-filter: blur(8px);
            border: 1px solid #262626;
        }
        .map-grid {
            background-image: radial-gradient(#262626 1px, transparent 1px);
            background-size: 30px 30px;
        }
        .region-node {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .region-node:hover {
            fill: #404040;
            stroke: #ffffff;
        }
        .region-highlight {
            fill: rgba(0, 128, 0, 0.2) !important;
            stroke: var(--brand-green) !important;
            stroke-width: 3px !important;
        }
        .correct-flash {
            animation: flash-green 0.5s ease-out;
        }
        .incorrect-flash {
            animation: flash-red 0.5s ease-out;
        }
        @keyframes flash-green {
            0% { background-color: transparent; }
            50% { background-color: rgba(0, 128, 0, 0.3); }
            100% { background-color: transparent; }
        }
        @keyframes flash-red {
            0% { background-color: transparent; }
            50% { background-color: rgba(255, 0, 0, 0.3); }
            100% { background-color: transparent; }
        }
        .modal-enter {
            animation: modal-fade-in 0.3s ease-out forwards;
        }
        @keyframes modal-fade-in {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .action-bar-slide {
            transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }
    </style>
</head>
<body class="font-sans">

    <!-- APP CONTAINER -->
    <div id="app-container" class="relative w-full h-full flex flex-col">
        
        <!-- HEADER (GLOBAL) -->
        <header id="app-header" class="h-16 border-b border-ui-border glass-panel flex items-center justify-between px-6 z-50">
            <div class="flex items-center gap-8">
                <div class="flex flex-col">
                    <span class="text-[10px] text-brand-grey font-mono uppercase tracking-widest">System Status</span>
                    <div class="flex items-center gap-4 text-sm font-mono">
                        <span id="game-status-indicator" class="text-brand-red">[üéÆ Game: OFF]</span>
                        <span class="text-brand-green">[üó∫Ô∏è Map: ON]</span>
                    </div>
                </div>
                <div class="h-8 w-[1px] bg-ui-border"></div>
                <div class="flex flex-col">
                    <span class="text-[10px] text-brand-grey font-mono uppercase tracking-widest">Application</span>
                    <span class="text-sm font-bold tracking-tighter">1DAL TRAINER <span class="text-brand-grey font-normal ml-2">v1.0.0</span></span>
                </div>
            </div>

            <button id="start-button" onclick="app.transitionToState('level-select')" class="px-6 py-2 bg-white text-black font-bold text-xs uppercase tracking-widest hover:bg-brand-green hover:text-white transition-colors">
                ‚ñ∂ START SESSION
            </button>
        </header>

        <!-- MAIN AREA -->
        <main class="relative flex-grow overflow-hidden flex">
            
            <!-- INFO PANELS (LEFT) -->
            <div class="absolute top-4 left-4 z-40 flex flex-col gap-4 pointer-events-none">
                <!-- Debug Info -->
                <div class="glass-panel p-4 w-64 pointer-events-auto">
                    <h3 class="text-[10px] text-brand-grey font-mono uppercase mb-2 border-b border-ui-border pb-1">Debug Statistics</h3>
                    <div id="debug-info-content" class="text-xs font-mono space-y-1">
                        <div class="flex justify-between"><span>RENDER_COUNT:</span><span class="text-brand-green" id="dbg-render">142</span></div>
                        <div class="flex justify-between"><span>ZOOM_LEVEL:</span><span id="dbg-zoom">1.00x</span></div>
                        <div class="flex justify-between"><span>COORDS:</span><span id="dbg-coords">0, 0</span></div>
                    </div>
                </div>

                <!-- Game Info -->
                <div class="glass-panel p-4 w-64 pointer-events-auto">
                    <h3 class="text-[10px] text-brand-grey font-mono uppercase mb-2 border-b border-ui-border pb-1">Session Data</h3>
                    <div id="game-info-content" class="text-xs font-mono space-y-1">
                        <div class="flex justify-between"><span>LEVEL:</span><span id="game-level">--</span></div>
                        <div class="flex justify-between"><span>PHASE:</span><span id="game-phase">--</span></div>
                        <div class="flex justify-between text-brand-green font-bold"><span>SCORE:</span><span id="game-score">0000</span></div>
                    </div>
                </div>
            </div>

            <!-- INTERACTIVE MAP AREA -->
            <div id="map-container" class="flex-grow map-grid relative overflow-hidden bg-black flex items-center justify-center">
                <!-- SVG Map Wrapper -->
                <svg id="svg-map" viewBox="0 0 800 600" class="w-[80%] h-auto max-h-[80vh]">
                    <!-- Simplified Regional Layout for Trainer -->
                    <g id="map-regions" stroke="#444" stroke-width="1" fill="#1a1a1a">
                        <rect id="reg-n" class="region-node" x="350" y="50" width="100" height="100" data-name="NORTH_SECTOR" />
                        <rect id="reg-nw" class="region-node" x="200" y="100" width="100" height="100" data-name="NORTHWEST_ZONE" />
                        <rect id="reg-ne" class="region-node" x="500" y="100" width="100" height="100" data-name="NORTHEAST_ZONE" />
                        <rect id="reg-c" class="region-node" x="350" y="200" width="100" height="100" data-name="CENTRAL_HUB" />
                        <rect id="reg-w" class="region-node" x="150" y="250" width="100" height="100" data-name="WEST_REACH" />
                        <rect id="reg-e" class="region-node" x="550" y="250" width="100" height="100" data-name="EAST_REACH" />
                        <rect id="reg-s" class="region-node" x="350" y="350" width="100" height="100" data-name="SOUTH_SECTOR" />
                        <rect id="reg-sw" class="region-node" x="200" y="400" width="100" height="100" data-name="SOUTHWEST_ZONE" />
                        <rect id="reg-se" class="region-node" x="500" y="400" width="100" height="100" data-name="SOUTHEAST_ZONE" />
                    </g>
                    <!-- Text Labels -->
                    <g pointer-events="none" font-family="JetBrains Mono" font-size="10" fill="#666">
                        <text x="400" y="105" text-anchor="middle">NORTH</text>
                        <text x="250" y="155" text-anchor="middle">NW</text>
                        <text x="550" y="155" text-anchor="middle">NE</text>
                        <text x="400" y="255" text-anchor="middle">CENTER</text>
                        <text x="200" y="305" text-anchor="middle">WEST</text>
                        <text x="600" y="305" text-anchor="middle">EAST</text>
                        <text x="400" y="405" text-anchor="middle">SOUTH</text>
                        <text x="250" y="455" text-anchor="middle">SW</text>
                        <text x="550" y="455" text-anchor="middle">SE</text>
                    </g>
                </svg>
            </div>

            <!-- ACTION BAR (TOP OVERLAY - SLIDING) -->
            <div id="action-bar" class="absolute top-0 left-0 w-full glass-panel z-40 action-bar-slide -translate-y-full border-b-2 border-brand-green py-6 flex flex-col items-center">
                <div class="max-w-2xl w-full px-8 flex justify-between items-center">
                    <div>
                        <span class="text-[10px] text-brand-grey font-mono uppercase block mb-1">Current Objective</span>
                        <h2 id="question-text" class="text-2xl font-extrabold tracking-tight">FIND THE <span class="text-brand-green">NORTH_SECTOR</span></h2>
                    </div>
                    <div class="text-right">
                        <span class="text-[10px] text-brand-grey font-mono uppercase block mb-1">Progress</span>
                        <div class="flex gap-1" id="streak-counter">
                            <div class="w-3 h-3 border border-brand-green"></div>
                            <div class="w-3 h-3 border border-brand-green"></div>
                            <div class="w-3 h-3 border border-brand-green"></div>
                            <div class="w-3 h-3 border border-brand-green"></div>
                            <div class="w-3 h-3 border border-brand-green"></div>
                        </div>
                    </div>
                </div>
                <div id="feedback-message" class="mt-4 font-mono text-sm opacity-0 transition-opacity">
                    SYSTEM: RESPONSE VALIDATED.
                </div>
            </div>

        </main>

        <!-- STATE: LEVEL SELECT (MODAL) -->
        <div id="state-level-select" class="fixed inset-0 z-[100] bg-black/80 backdrop-blur-md hidden items-center justify-center p-6">
            <div class="glass-panel w-full max-w-lg modal-enter">
                <div class="p-6 border-b border-ui-border flex justify-between items-center">
                    <h2 class="text-xl font-bold tracking-tighter uppercase">Mission Parameters</h2>
                    <button onclick="app.transitionToState('initial')" class="text-brand-grey hover:text-white font-mono text-xs">[X CLOSE]</button>
                </div>
                <div class="p-8 space-y-6">
                    <!-- Level 1 -->
                    <button onclick="app.startGame(1)" class="w-full group text-left border border-ui-border p-4 hover:border-brand-green transition-colors">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-xs font-mono text-brand-green">LEVEL 001</span>
                            <span class="text-[10px] bg-brand-green/20 text-brand-green px-2 py-0.5 font-mono">AVAILABLE</span>
                        </div>
                        <h3 class="text-lg font-bold mb-1">REGION IDENTIFICATION</h3>
                        <p class="text-xs text-brand-grey">Phase 1: Adaptive Orientation. Guided identification of administrative sectors.</p>
                    </button>

                    <!-- Locked Level -->
                    <div class="w-full text-left border border-ui-border p-4 opacity-40 cursor-not-allowed">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-xs font-mono text-brand-grey">LEVEL 002</span>
                            <span class="text-[10px] bg-brand-grey/20 text-brand-grey px-2 py-0.5 font-mono">LOCKED</span>
                        </div>
                        <h3 class="text-lg font-bold mb-1">CHRONO-MAPPING</h3>
                        <p class="text-xs text-brand-grey">Phase 2: High-velocity spatial verification. Time-sensitive operations.</p>
                    </div>

                    <div class="w-full text-left border border-ui-border p-4 opacity-40 cursor-not-allowed">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-xs font-mono text-brand-grey">LEVEL 003</span>
                            <span class="text-[10px] bg-brand-grey/20 text-brand-grey px-2 py-0.5 font-mono">LOCKED</span>
                        </div>
                        <h3 class="text-lg font-bold mb-1">BLIND RECALL</h3>
                        <p class="text-xs text-brand-grey">Phase 3: Zero-hint verification. Error results in immediate termination.</p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        const app = {
            currentState: 'initial',
            currentLevel: 1,
            currentPhase: 'Adaptive',
            score: 0,
            consecutiveCorrect: 0,
            targetRegion: null,
            regions: [
                { id: 'reg-n', name: 'NORTH_SECTOR' },
                { id: 'reg-nw', name: 'NORTHWEST_ZONE' },
                { id: 'reg-ne', name: 'NORTHEAST_ZONE' },
                { id: 'reg-c', name: 'CENTRAL_HUB' },
                { id: 'reg-w', name: 'WEST_REACH' },
                { id: 'reg-e', name: 'EAST_REACH' },
                { id: 'reg-s', name: 'SOUTH_SECTOR' },
                { id: 'reg-sw', name: 'SOUTHWEST_ZONE' },
                { id: 'reg-se', name: 'SOUTHEAST_ZONE' }
            ],

            init() {
                this.setupEventListeners();
                this.updateDebug();
            },

            setupEventListeners() {
                const regionNodes = document.querySelectorAll('.region-node');
                regionNodes.forEach(node => {
                    node.addEventListener('click', (e) => {
                        this.handleRegionClick(e.target.id, e.target.dataset.name);
                    });
                    
                    node.addEventListener('mousemove', (e) => {
                        document.getElementById('dbg-coords').textContent = `${e.offsetX}, ${e.offsetY}`;
                    });
                });

                window.addEventListener('resize', () => this.updateDebug());
            },

            transitionToState(newState) {
                const states = {
                    'initial': () => {
                        document.getElementById('state-level-select').style.display = 'none';
                        document.getElementById('action-bar').classList.add('-translate-y-full');
                        document.getElementById('start-button').style.display = 'block';
                        document.getElementById('game-status-indicator').textContent = '[üéÆ Game: OFF]';
                        document.getElementById('game-status-indicator').className = 'text-brand-red';
                        this.resetHighlights();
                    },
                    'level-select': () => {
                        document.getElementById('state-level-select').style.display = 'flex';
                    },
                    'game-active': () => {
                        document.getElementById('state-level-select').style.display = 'none';
                        document.getElementById('action-bar').classList.remove('-translate-y-full');
                        document.getElementById('start-button').style.display = 'none';
                        document.getElementById('game-status-indicator').textContent = '[üéÆ Game: ON]';
                        document.getElementById('game-status-indicator').className = 'text-brand-green';
                    }
                };

                if (states[newState]) {
                    states[newState]();
                    this.currentState = newState;
                }
            },

            startGame(level) {
                this.currentLevel = level;
                this.score = 0;
                this.consecutiveCorrect = 0;
                this.currentPhase = "Phase 1 (Easy)";
                this.transitionToState('game-active');
                this.updateUI();
                this.generateNewQuestion();
            },

            generateNewQuestion() {
                const randomIndex = Math.floor(Math.random() * this.regions.length);
                this.targetRegion = this.regions[randomIndex];
                
                document.getElementById('question-text').innerHTML = `FIND THE <span class="text-brand-green">${this.targetRegion.name}</span>`;
                
                // Highlight target (Phase 1 Hint)
                this.resetHighlights();
                document.getElementById(this.targetRegion.id).classList.add('region-highlight');
                
                this.updateUI();
            },

            handleRegionClick(id, name) {
                if (this.currentState !== 'game-active') return;

                const isCorrect = (id === this.targetRegion.id);
                this.displayFeedback(isCorrect);

                if (isCorrect) {
                    this.score += 100;
                    this.consecutiveCorrect++;
                    if (this.consecutiveCorrect >= 5) {
                        this.currentPhase = "Phase 2 (Normal)";
                    }
                } else {
                    this.consecutiveCorrect = 0;
                }

                this.updateUI();
                
                // Generate next after delay
                setTimeout(() => {
                    this.generateNewQuestion();
                }, 800);
            },

            displayFeedback(isCorrect) {
                const bar = document.getElementById('action-bar');
                const feedback = document.getElementById('feedback-message');
                
                bar.classList.remove('border-brand-green', 'border-brand-red');
                bar.classList.add(isCorrect ? 'border-brand-green' : 'border-brand-red');
                bar.classList.add(isCorrect ? 'correct-flash' : 'incorrect-flash');
                
                feedback.textContent = isCorrect ? 'SYSTEM: RESPONSE VALIDATED. CORRECT.' : 'SYSTEM: DATA MISMATCH. INCORRECT.';
                feedback.className = `mt-4 font-mono text-sm opacity-100 ${isCorrect ? 'text-brand-green' : 'text-brand-red'}`;

                setTimeout(() => {
                    bar.classList.remove('correct-flash', 'incorrect-flash');
                    feedback.style.opacity = '0';
                    bar.classList.remove('border-brand-red');
                    bar.classList.add('border-brand-green');
                }, 800);
            },

            resetHighlights() {
                this.regions.forEach(r => {
                    document.getElementById(r.id).classList.remove('region-highlight');
                });
            },

            updateUI() {
                document.getElementById('game-level').textContent = `00${this.currentLevel}`;
                document.getElementById('game-phase').textContent = this.currentPhase;
                document.getElementById('game-score').textContent = this.score.toString().padStart(4, '0');

                // Streak counter dots
                const dots = document.getElementById('streak-counter').children;
                for (let i = 0; i < dots.length; i++) {
                    if (i < this.consecutiveCorrect) {
                        dots[i].classList.add('bg-brand-green');
                    } else {
                        dots[i].classList.remove('bg-brand-green');
                    }
                }
            },

            updateDebug() {
                const renderCount = parseInt(document.getElementById('dbg-render').textContent);
                document.getElementById('dbg-render').textContent = renderCount + 1;
                
                // Simulate zoom calculation
                const mapWidth = document.getElementById('svg-map').clientWidth;
                const zoom = (mapWidth / 800).toFixed(2);
                document.getElementById('dbg-zoom').textContent = `${zoom}x`;
            }
        };

        // Initialize Application
        window.onload = () => app.init();
    </script>
</body>
</html>
